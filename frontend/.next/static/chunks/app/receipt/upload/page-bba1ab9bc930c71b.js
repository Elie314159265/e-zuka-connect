(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[637],{5475:function(e,t,r){Promise.resolve().then(r.bind(r,2347))},8030:function(e,t,r){"use strict";r.d(t,{Z:function(){return u}});var l=r(2265);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),s=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()),n=e=>{let t=s(e);return t.charAt(0).toUpperCase()+t.slice(1)},i=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()},d=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var c={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let o=(0,l.forwardRef)((e,t)=>{let{color:r="currentColor",size:a=24,strokeWidth:s=2,absoluteStrokeWidth:n,className:o="",children:u,iconNode:h,...m}=e;return(0,l.createElement)("svg",{ref:t,...c,width:a,height:a,stroke:r,strokeWidth:n?24*Number(s)/Number(a):s,className:i("lucide",o),...!u&&!d(m)&&{"aria-hidden":"true"},...m},[...h.map(e=>{let[t,r]=e;return(0,l.createElement)(t,r)}),...Array.isArray(u)?u:[u]])}),u=(e,t)=>{let r=(0,l.forwardRef)((r,s)=>{let{className:d,...c}=r;return(0,l.createElement)(o,{ref:s,iconNode:t,className:i("lucide-".concat(a(n(e))),"lucide-".concat(e),d),...c})});return r.displayName=n(e),r}},2584:function(e,t,r){"use strict";r.d(t,{Z:function(){return l}});let l=(0,r(8030).Z)("cloud-upload",[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]])},6127:function(e,t,r){"use strict";r.d(t,{Z:function(){return l}});let l=(0,r(8030).Z)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},2347:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return h}});var l=r(7437),a=r(2265),s=r(6349),n=r(2584),i=r(8030);let d=(0,i.Z)("loader",[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]]),c=(0,i.Z)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);var o=r(6127);let u=(0,i.Z)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);function h(){let[e,t]=(0,a.useState)(null),[r,i]=(0,a.useState)(null),[h,m]=(0,a.useState)(null),[p,x]=(0,a.useState)(!1),[f,g]=(0,a.useState)(null),b=async t=>{if(t.preventDefault(),!e){g("まずファイルを選択してください。");return}x(!0),g(null),m(null);let r=new FormData;r.append("file",e);try{let e=await fetch("/api/receipts/upload",{method:"POST",body:r}),t=await e.json();if(!e.ok)throw Error(t.detail||"解析に失敗しました。");m(t.ocr_result)}catch(e){g(e instanceof Error?e.message:"不明なエラーが発生しました。")}finally{x(!1)}};return(0,l.jsx)("div",{className:"min-h-screen bg-gray-50 py-24 px-4",children:(0,l.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,l.jsx)("h1",{className:"text-4xl font-bold text-center mb-8",children:"レシートアップロード"}),(0,l.jsxs)("form",{onSubmit:b,className:"bg-white p-8 rounded-2xl shadow-lg",children:[(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsxs)("label",{htmlFor:"receipt-upload",className:"cursor-pointer block border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:bg-gray-50 transition-colors",children:[(0,l.jsx)(n.Z,{className:"w-16 h-16 mx-auto text-gray-400 mb-4"}),(0,l.jsx)("span",{className:"text-lg font-semibold text-gray-600",children:"クリックしてファイルを選択"}),(0,l.jsx)("p",{className:"text-gray-500 text-sm mt-1",children:"（または、ここにドラッグ＆ドロップ）"})]}),(0,l.jsx)("input",{id:"receipt-upload",type:"file",className:"hidden",onChange:e=>{var r;let l=null===(r=e.target.files)||void 0===r?void 0:r[0];if(l){t(l);let e=new FileReader;e.onloadend=()=>{i(e.result)},e.readAsDataURL(l),m(null),g(null)}},accept:"image/png, image/jpeg"})]}),r&&(0,l.jsxs)("div",{className:"mb-6 text-center",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"プレビュー"}),(0,l.jsx)("img",{src:r,alt:"Receipt preview",className:"max-w-full max-h-64 mx-auto rounded-lg shadow-md"})]}),(0,l.jsxs)(s.E.button,{type:"submit",disabled:!e||p,className:"w-full bg-blue-600 text-white font-bold py-3 px-4 rounded-lg flex items-center justify-center space-x-2 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50",whileHover:{scale:!e||p?1:1.05},whileTap:{scale:!e||p?1:.95},children:[p?(0,l.jsx)(d,{className:"animate-spin"}):(0,l.jsx)(c,{}),(0,l.jsx)("span",{children:p?"解析中...":"レシートを解析する"})]})]}),f&&(0,l.jsxs)("div",{className:"mt-6 bg-red-100 border-l-4 border-red-500 text-red-700 p-4 rounded-lg flex items-center",children:[(0,l.jsx)(o.Z,{className:"w-6 h-6 mr-3"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"font-bold",children:"エラー"}),(0,l.jsx)("p",{children:f})]})]}),h&&(0,l.jsxs)("div",{className:"mt-6 bg-white p-8 rounded-2xl shadow-lg",children:[(0,l.jsxs)("h2",{className:"text-2xl font-bold mb-4 flex items-center",children:[(0,l.jsx)(u,{className:"w-8 h-8 text-green-500 mr-3"})," 解析結果"]}),(0,l.jsxs)("div",{className:"space-y-2 text-gray-700",children:[(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"店名:"})," ",h.supplier_name||"N/A"]}),(0,l.jsxs)("p",{children:[(0,l.jsx)("strong",{children:"合計金額:"})," ",h.total_amount||"N/A"]}),(0,l.jsx)("h3",{className:"text-lg font-semibold pt-2",children:"購入品目:"}),(0,l.jsx)("ul",{className:"list-disc list-inside pl-4",children:h.line_items.map((e,t)=>(0,l.jsxs)("li",{children:[e.description," - ",e.amount]},t))})]}),(0,l.jsx)("button",{onClick:()=>{alert("（TODO: この内容でデータベースに保存する処理を実装します）")},className:"mt-6 w-full bg-green-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-green-700 transition-colors",children:"この内容で登録する"})]})]})})}}},function(e){e.O(0,[349,971,23,744],function(){return e(e.s=5475)}),_N_E=e.O()}]);